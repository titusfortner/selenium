language: java
sudo: false

script:
  - rvm install ruby-2.2.3
  - rvm use 2.2.3
  - |
    set -e
    set -x

    sh -e /etc/init.d/xvfb start

    export CHROME_REVISION=354250
    export CHROMEDRIVER_VERSION=`curl -s http://chromedriver.storage.googleapis.com/LATEST_RELEASE`

    curl -L -O "http://commondatastorage.googleapis.com/chromium-browser-snapshots/Linux_x64/354250/chrome-linux.zip"
    unzip chrome-linux.zip

    curl -L -O "http://chromedriver.storage.googleapis.com/${CHROMEDRIVER_VERSION}/chromedriver_linux64.zip"
    unzip chromedriver_linux64.zip

    mv chromedriver chrome-linux/chromedriver
    chmod +x chrome-linux/chromedriver

    export chrome_binary=$PWD/chrome-linux/chrome
    export chromedriver=$PWD/chrome-linux/chromedriver

  - ./go //rb:chrome-test
